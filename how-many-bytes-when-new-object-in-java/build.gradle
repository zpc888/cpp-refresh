/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/6.8.3/samples
 */

apply plugin: 'java'

repositories {
    mavenLocal()
    mavenCentral()
}

dependencies {
    compile group: 'org.openjdk.jol', name: 'jol-core', version: "0.10"
}

task fatNewObject(type: Jar) {
    manifest {
        attributes 'Implementation-Title': 'Heap Memory Measure',
                    'Implementation-Version': '1.0',
                    'Main-Class': 'mem.NewObjectTeller'
    }
    baseName = "tell-new-object-bytes"
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

task fatNewObjectArray(type: Jar) {
    manifest {
        attributes 'Implementation-Title': 'Heap Memory Measure',
                    'Implementation-Version': '1.0',
                    'Main-Class': 'mem.NewObjectArrayTeller'
    }
    baseName = "tell-new-object-array-bytes"
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

task fatNewCustom(type: Jar) {
    manifest {
        attributes 'Implementation-Title': 'Heap Memory Measure',
                    'Implementation-Version': '1.0',
                    'Main-Class': 'mem.NewMyCustomTeller'
    }
    baseName = "tell-new-custom-bytes"
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

task fatNewComplex(type: Jar) {
    manifest {
        attributes 'Implementation-Title': 'Heap Memory Measure',
                    'Implementation-Version': '1.0',
                    'Main-Class': 'mem.NewComplexTeller'
    }
    baseName = "tell-new-complex-bytes"
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

task fatJar() {
    dependsOn(fatNewObject)
    dependsOn(fatNewObjectArray)
    dependsOn(fatNewCustom)
    dependsOn(fatNewComplex)
}